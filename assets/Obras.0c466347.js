var F=Object.defineProperty,N=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var E=(n,e,r)=>e in n?F(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,g=(n,e)=>{for(var r in e||(e={}))T.call(e,r)&&E(n,r,e[r]);if(V)for(var r of V(e))j.call(e,r)&&E(n,r,e[r]);return n},U=(n,e)=>N(n,$(e));import{Y as c,M as P,O as G,o as m,c as b,a as t,t as u,az as H,ad as i,aA as d,aG as J,u as A,aj as q,as as R,f as K,b as C,e as w,al as L,aH as Y,aE as M,aB as I,aI as Q,aJ as W,aK as X,aL as Z,aM as aa}from"./index.c5bf7064.js";const ta={class:"bg-secondary pt-10 pb-15"},sa={class:"container"},oa={class:"mb-3"},ea={class:"mb-3"},la={class:"mb-3"},ra={class:"mb-3"},na={class:"mb-3"},ia={class:"mb-3"},da=["value"],ua={class:"mb-3"},pa={class:"mb-3"},ca={class:"mb-3"},ma={class:"mb-3"},ba={key:0,class:"mt-2"},va=["src"],fa={key:1,class:"text-danger"},ya=["disabled"],ga={class:"mt-5"},wa={class:"list-group"},ka={class:"mb-0"},Da={class:"mb-0"},Ua=["onClick"],_a=["onClick"],Ea={__name:"Obras",setup(n){const e=c(null),r=c(null),p=c(null),k=c(!1),v=c(!1),_=c([]),O=["A partir de 2 anos","A partir de 3 anos","A partir de 4 anos","A partir de 13 anos","A partir de 18 anos"],o=P({id:"",title:"",company:"",director:"",cast:"",synopsis:"",date:"",link:"",age:"",price:"",photo:""}),y=async()=>{try{const l=await K(C(w,"obras"));_.value=l.docs.map(a=>g({id:a.id},a.data()))}catch(l){console.error("Error al obtener datos:",l)}},S=async l=>{try{await Y(M(w,"obras",l)),y()}catch(a){console.error("Error al eliminar dato:",a)}},h=l=>{const a=l.target.files[0];if(a&&["image/jpeg","image/png"].includes(a.type)){e.value=a,p.value=null;const s=new FileReader;s.readAsDataURL(a),s.onload=f=>{r.value=f.target.result}}else p.value="Archivo no v\xE1lido",e.value=null},x=async()=>{if(!e.value)throw new Error("No hay archivo para subir");const l=W(X,`imagenes/${e.value.name}`),a=Z(l,e.value);return new Promise((s,f)=>{a.on("state_changed",null,D=>f(D),async()=>{const D=await aa(a.snapshot.ref);s(D)})})},z=async()=>{try{v.value=!0;const l=await x();await I(C(w,"obras"),U(g({},o),{photo:l})),p.value="Datos guardados con \xE9xito",y()}catch(l){console.error("Error al agregar datos:",l)}finally{v.value=!1}},B=async()=>{try{v.value=!0;const l=e.value?await x():o.photo;await Q(M(w,"obras",o.id),U(g({},o),{photo:l})),p.value="Datos actualizados con \xE9xito",y()}catch(l){console.error("Error al actualizar datos:",l)}finally{v.value=!1}};return G(()=>{y()}),(l,a)=>(m(),b("div",ta,[t("div",sa,[t("h2",null,u(k.value?"Editar Obra":"Nueva Obra"),1),t("form",{onSubmit:a[9]||(a[9]=H(s=>k.value?B():z(),["prevent"]))},[t("div",oa,[a[10]||(a[10]=t("label",{for:"title",class:"form-label"},"T\xEDtulo",-1)),i(t("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=s=>o.title=s),required:""},null,512),[[d,o.title]])]),t("div",ea,[a[11]||(a[11]=t("label",{for:"company",class:"form-label"},"Compa\xF1\xEDa",-1)),i(t("input",{type:"text",id:"company",class:"form-control","onUpdate:modelValue":a[1]||(a[1]=s=>o.company=s),required:""},null,512),[[d,o.company]])]),t("div",la,[a[12]||(a[12]=t("label",{for:"director",class:"form-label"},"Director",-1)),i(t("input",{type:"text",id:"director",class:"form-control","onUpdate:modelValue":a[2]||(a[2]=s=>o.director=s),required:""},null,512),[[d,o.director]])]),t("div",ra,[a[13]||(a[13]=t("label",{for:"cast",class:"form-label"},"Reparto",-1)),i(t("input",{type:"text",id:"cast",class:"form-control","onUpdate:modelValue":a[3]||(a[3]=s=>o.cast=s),required:""},null,512),[[d,o.cast]])]),t("div",na,[a[14]||(a[14]=t("label",{for:"synopsis",class:"form-label"},"Sinopsis",-1)),i(t("textarea",{id:"synopsis",class:"form-control","onUpdate:modelValue":a[4]||(a[4]=s=>o.synopsis=s),rows:"3",required:""},null,512),[[d,o.synopsis]])]),t("div",ia,[a[16]||(a[16]=t("label",{for:"age",class:"form-label"},"Edad Recomendada",-1)),i(t("select",{id:"age",class:"form-select","onUpdate:modelValue":a[5]||(a[5]=s=>o.age=s),required:""},[a[15]||(a[15]=t("option",{value:"",disabled:""},"Seleccione una opci\xF3n",-1)),(m(),b(A,null,q(O,s=>t("option",{key:s,value:s},u(s),9,da)),64))],512),[[J,o.age]])]),t("div",ua,[a[17]||(a[17]=t("label",{for:"date",class:"form-label"},"Fecha",-1)),i(t("input",{type:"date",id:"date",class:"form-control","onUpdate:modelValue":a[6]||(a[6]=s=>o.date=s),required:""},null,512),[[d,o.date]])]),t("div",pa,[a[18]||(a[18]=t("label",{for:"price",class:"form-label"},"Precio",-1)),i(t("input",{type:"number",id:"price",class:"form-control","onUpdate:modelValue":a[7]||(a[7]=s=>o.price=s),required:""},null,512),[[d,o.price]])]),t("div",ca,[a[19]||(a[19]=t("label",{for:"link",class:"form-label"},"Enlace",-1)),i(t("input",{type:"url",id:"link",class:"form-control","onUpdate:modelValue":a[8]||(a[8]=s=>o.link=s)},null,512),[[d,o.link]])]),t("div",ma,[a[20]||(a[20]=t("label",{for:"photo",class:"form-label"},"Foto",-1)),t("input",{type:"file",id:"photo",class:"form-control",onChange:h},null,32),r.value?(m(),b("div",ba,[t("img",{src:r.value,alt:"Vista previa",class:"img-thumbnail"},null,8,va)])):R("",!0),p.value?(m(),b("div",fa,u(p.value),1)):R("",!0)]),t("button",{type:"submit",class:"btn btn-primary",disabled:v.value},u(k.value?"Actualizar":"Agregar"),9,ya)],32),t("div",ga,[a[23]||(a[23]=t("h3",null,"Obras",-1)),t("ul",wa,[(m(!0),b(A,null,q(_.value,s=>(m(),b("li",{key:s.id,class:"list-group-item d-flex justify-content-between align-items-center"},[t("div",null,[t("h5",null,u(s.title),1),t("p",ka,[a[21]||(a[21]=t("strong",null,"Compa\xF1\xEDa:",-1)),L(" "+u(s.company),1)]),t("p",Da,[a[22]||(a[22]=t("strong",null,"Director:",-1)),L(" "+u(s.director),1)])]),t("div",null,[t("button",{class:"btn btn-warning me-2",onClick:f=>l.obtenerDatoID(s.id)},"Editar",8,Ua),t("button",{class:"btn btn-danger",onClick:f=>S(s.id)},"Eliminar",8,_a)])]))),128))])])])]))}};export{Ea as default};
