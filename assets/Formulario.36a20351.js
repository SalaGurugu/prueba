var R=Object.defineProperty,E=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var f=(a,e,o)=>e in a?R(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o,V=(a,e)=>{for(var o in e||(e={}))B.call(e,o)&&f(a,o,e[o]);if(y)for(var o of y(e))F.call(e,o)&&f(a,o,e[o]);return a},v=(a,e)=>E(a,A(e));import{k as i,q as d,A as s,B as u,I as T,F as x,D as I,C as q,y as n,u as r,J as $,K as k,L as p}from"./@vue.ecae8ed8.js";import{d as m,s as D,N as L}from"./index.4269a66f.js";import{d as z}from"./pinia.881045cc.js";import{e as M,w as _,o as Y,b as h,Y as j,c as w,u as U,d as g,f as G,h as J}from"./@firebase.686d954b.js";import{u as C}from"./vue-router.22e563bd.js";import"./firebase.ccf1e96b.js";import"./bootstrap.f0de601a.js";import"./@popperjs.2eb7191b.js";import"./tslib.285d8b56.js";const K={class:"container"},P={class:"mb-3"},H={class:"form-label"},O=["placeholder","value"],c={props:{label:{type:String,default:""},modelValue:{type:[String,Number],default:""}},setup(a){return(e,o)=>(i(),d("div",K,[s("div",P,[s("label",H,u(a.label),1),s("input",{type:"text",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=t=>e.$emit("update:modelValue",t.target.value))},null,40,O)])]))}},Q={class:"container"},W={class:"mb-3"},X={class:"form-label"},Z=["placeholder","value"],ee={props:{label:{type:String,default:""},modelValue:{type:[Date,String,Number],default:""}},setup(a){return(e,o)=>(i(),d("div",Q,[s("div",W,[s("label",X,u(a.label),1),s("input",{type:"date",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=t=>e.$emit("update:modelValue",t.target.value))},null,40,Z)])]))}},te={class:"container"},ae={class:"mb-3"},oe={class:"form-label"},le=["placeholder","value"],se={props:{label:{type:String,default:""},modelValue:{type:[String,Number],default:""}},setup(a){return(e,o)=>(i(),d("div",te,[s("div",ae,[s("label",oe,u(a.label),1),s("textarea",{type:"text",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=t=>e.$emit("update:modelValue",t.target.value)),rows:"3"},null,40,le)])]))}},re={class:"container"},ne={class:"mb-3"},ie={class:"form-label"},de=["value"],ue=["value","selected"],ce={props:{opciones:{type:Array,required:!0},label:{type:String,default:""},modelValue:{type:[String,Number],default:""}},setup(a){return(e,o)=>(i(),d("div",re,[s("div",ne,[s("label",ie,u(a.label),1),s("select",T({class:"form-select",value:a.modelValue},v(V({},e.$attrs),{onChange:t=>{e.$emit("update:modelValue",t.target.value)}})),[(i(!0),d(x,null,I(a.opciones,t=>(i(),d("option",{value:t,key:t,selected:t===a.modelValue},u(t),9,ue))),128))],16,de)])]))}},S=C(),me=z({id:"principal",state:()=>({file:null,datoImagen:null,error:null,editar:!1,loading:!1,urlDescarga:"",ages:["2 anos","3 anos","4 anos","Todas as idades","Recomendado para adultos"],obras:[],obra:{id:"",title:"",company:"",director:"",cast:"",synopsis:"",date:"",link:"",age:"",time:"",photo:""}}),actions:{async obtenerDatos(){this.obras=[],(await M(_(m,"obras"))).forEach(e=>{let o=e.data();o.id=e.id,this.obras.push(o),console.log(o)})},async eliminarDato(a){await Y(h(m,"obras",a)),S.go("/")},async obtenerDatoID(a){const e=h(m,"obras",a),o=await j(e);o.exists()?(this.obra=o.data(),this.obra.id=o.id):console.log("\xA1No existe el documento!")},buscarImagen(a){const e=a.target.files[0].type;if(e==="image/jpeg"||e==="image/png")this.file=a.target.files[0],this.error=null;else{this.error="Archivo no v\xE1lido",this.file=null;return}const o=new FileReader;o.readAsDataURL(this.file),o.onload=t=>{this.datoImagen=t.target.result}},async agregarDato(){try{this.loading=!0;const a=w(D,"imagenes/"+this.file.name),e=U(a,this.file);e.on("state_changed",t=>{const l=t.bytesTransferred/t.totalBytes*100;switch(console.log("Upload is "+l+"% done"),t.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break}},t=>{},()=>{g(e.snapshot.ref).then(t=>{console.log("File available at",t)})});const o=await g(a);await G(_(m,"obras"),{title:this.obra.title,company:this.obra.company,director:this.obra.director,cast:this.obra.cast,synopsis:this.obra.synopsis,age:this.obra.age,link:this.obra.link,time:this.obra.time,date:this.obra.date,photo:o}),this.error="Imagen subida con \xE9xito",this.file=null}catch(a){console.log(a)}finally{C().push("/"),this.loading=!1}},async actualizarDato(){try{this.loading=!0;const a=w(D,"imagenes/"+this.file.name),e=U(a,this.file);e.on("state_changed",l=>{const b=l.bytesTransferred/l.totalBytes*100;switch(console.log("Upload is "+b+"% done"),l.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break}},l=>{},()=>{g(e.snapshot.ref).then(l=>{console.log("File available at",l)})});const o=await g(a),t=h(m,"obras",this.obra.id);await J(t,{title:this.obra.title,company:this.obra.company,director:this.obra.director,cast:this.obra.cast,synopsis:this.obra.synopsis,age:this.obra.age,link:this.obra.link,time:this.obra.time,date:this.obra.date,photo:o}),this.error="Imagen subida con \xE9xito",this.file=null}catch(a){console.log(a)}finally{S.push("/"),this.loading=!1}}}}),be={class:"container my-4"},pe={class:"input-group my-3"},ge={class:"mt-3"},he={class:"mt-4"},ye=["src"],fe={class:"table"},Ve=s("thead",null,[s("tr",null,[s("th",{scope:"col"},"id"),s("th",{scope:"col"},"Author"),s("th",{scope:"col"},"Fecha"),s("th",{scope:"col"},"Editar"),s("th",{scope:"col"},"Eliminar")])],-1),ve={scope:"row"},$e=["onClick"],ke=["onClick"],Ee={setup(a){const e=me();return q(()=>{e.obtenerDatos()}),(o,t)=>(i(),d("div",null,[n(L),s("div",be,[s("form",null,[n(c,{modelValue:r(e).obra.company,"onUpdate:modelValue":t[0]||(t[0]=l=>r(e).obra.company=l),type:"text",label:"Compa\xF1ia"},null,8,["modelValue"]),n(c,{modelValue:r(e).obra.title,"onUpdate:modelValue":t[1]||(t[1]=l=>r(e).obra.title=l),type:"text",label:"T\xEDtulo"},null,8,["modelValue"]),n(c,{modelValue:r(e).obra.director,"onUpdate:modelValue":t[2]||(t[2]=l=>r(e).obra.director=l),type:"text",label:"Director"},null,8,["modelValue"]),n(c,{modelValue:r(e).obra.cast,"onUpdate:modelValue":t[3]||(t[3]=l=>r(e).obra.cast=l),type:"text",label:"Elenco"},null,8,["modelValue"]),n(se,{modelValue:r(e).obra.synopsis,"onUpdate:modelValue":t[4]||(t[4]=l=>r(e).obra.synopsis=l),type:"text",label:"Descripci\xF3n"},null,8,["modelValue"]),n(c,{modelValue:r(e).obra.link,"onUpdate:modelValue":t[5]||(t[5]=l=>r(e).obra.link=l),type:"text",label:"Enlace"},null,8,["modelValue"]),n(ce,{modelValue:r(e).obra.age,"onUpdate:modelValue":t[6]||(t[6]=l=>r(e).obra.age=l),opciones:r(e).ages,label:"Selecciona una categor\xEDa"},null,8,["modelValue","opciones"]),n(c,{modelValue:r(e).obra.time,"onUpdate:modelValue":t[7]||(t[7]=l=>r(e).obra.time=l),type:"text",default:"60 minutos",label:"Duraci\xF3n"},null,8,["modelValue"]),n(ee,{modelValue:r(e).obra.date,"onUpdate:modelValue":t[8]||(t[8]=l=>r(e).obra.date=l),type:"date",label:"Fecha"},null,8,["modelValue"]),n(c,{modelValue:r(e).obra.photo,"onUpdate:modelValue":t[9]||(t[9]=l=>r(e).obra.photo=l),type:"text",label:"Imagen"},null,8,["modelValue"]),s("div",pe,[s("input",{type:"file",onChange:t[10]||(t[10]=l=>r(e).buscarImagen(l))},null,32)]),s("div",ge,[$(s("button",{onClick:t[11]||(t[11]=p(l=>r(e).actualizarDato(o.id),["prevent"])),class:"btn btn-primary"}," Actualizar ",512),[[k,r(e).editar===!0]]),$(s("button",{onClick:t[12]||(t[12]=p(l=>r(e).agregarDato(),["prevent"])),class:"btn btn-primary"}," Guardar ",512),[[k,r(e).editar===!1]]),s("div",he,[s("img",{src:r(e).datoImagen},null,8,ye)])])])]),s("table",fe,[Ve,s("tbody",null,[(i(!0),d(x,null,I(r(e).obras,(l,b)=>(i(),d("tr",{key:b},[s("th",ve,u(b),1),s("td",null,u(l.company),1),s("td",null,u(l.date),1),s("td",null,[s("button",{onClick:p(N=>{r(e).obtenerDatoID(l.id),this.datos.editar=!this.datos.editar},["prevent"]),class:"btn btn-primary"},"Editar ",8,$e)]),s("td",null,[s("button",{onClick:p(N=>r(e).eliminarDato(l.id),["prevent"]),class:"btn btn-danger"},"Eliminar ",8,ke)])]))),128))])])]))}};export{Ee as default};
